{% extends "admin/base.html" %}
{% block title %}æ–‡ç« ç®¡ç†{% endblock %}

{% block content %}
<div class="admin-header">
  <h1>æ–‡ç« ç®¡ç†</h1>
  <div class="admin-actions">
    <!-- ä¸Šä¼  MD æ–‡ä»¶ -->
    <form method="post" action="{{ url_for('admin_upload') }}" enctype="multipart/form-data" style="display:inline;">
      <label class="btn btn-secondary upload-label">
        ğŸ“¤ ä¸Šä¼  MD æ–‡ä»¶
        <input type="file" name="file" accept=".md" onchange="this.form.submit()" style="display:none;" />
      </label>
    </form>
    <a href="{{ url_for('admin_new') }}" class="btn btn-primary">âœï¸ æ–°å»ºæ–‡ç« </a>
  </div>
</div>

<div class="admin-table-wrap">
  <table class="admin-table">
    <thead>
      <tr>
        <th>æ ‡é¢˜</th>
        <th>æ–‡ä»¶å</th>
        <th>æ—¥æœŸ</th>
        <th>æ ‡ç­¾</th>
        <th>æ“ä½œ</th>
      </tr>
    </thead>
    <tbody>
      {% for post in posts %}
      <tr>
        <td><a href="{{ url_for('post_detail', slug=post.slug) }}" target="_blank">{{ post.title }}</a></td>
        <td class="filename">{{ post.filename }}</td>
        <td>{{ post.date_str }}</td>
        <td>
          {% for tag in post.tags %}
            <span class="tag">#{{ tag }}</span>
          {% endfor %}
        </td>
        <td class="actions">
          <a href="{{ url_for('admin_edit', slug=post.slug) }}" class="btn btn-sm btn-secondary">ç¼–è¾‘</a>
          <form method="post" action="{{ url_for('admin_delete', slug=post.slug) }}" style="display:inline;"
                onsubmit="return confirm('ç¡®å®šåˆ é™¤ã€Š{{ post.title }}ã€‹ï¼Ÿ')">
            <button type="submit" class="btn btn-sm btn-danger">åˆ é™¤</button>
          </form>
        </td>
      </tr>
      {% else %}
      <tr><td colspan="5" style="text-align:center; color:#aaa; padding:2rem;">æš‚æ— æ–‡ç« </td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
